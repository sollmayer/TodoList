(()=>{"use strict";class e{constructor(e){this.title=e,this.taskList=[]}}let t=[...JSON.parse(localStorage.getItem("ProjectList"))||[]];const r=()=>JSON.parse(localStorage.getItem("ProjectList"))||[],n=(e,r,n,a)=>{t=t.map((t=>(e===t.title&&t.taskList.forEach((e=>{r===e.title&&(e[n]=a)})),t))),localStorage.setItem("ProjectList",JSON.stringify(t))};function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function s(e){o(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===a(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function i(e){o(1,arguments);var t=s(e);return t.setHours(0,0,0,0),t}Math.pow(10,8);var l=36e5;function c(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function d(e,t){var r;o(1,arguments);var n=c(null!==(r=null==t?void 0:t.additionalDigits)&&void 0!==r?r:2);if(2!==n&&1!==n&&0!==n)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var a,s=function(e){var t,r={},n=e.split(u.dateTimeDelimiter);if(n.length>2)return r;if(/:/.test(n[0])?t=n[0]:(r.date=n[0],t=n[1],u.timeZoneDelimiter.test(r.date)&&(r.date=e.split(u.timeZoneDelimiter)[0],t=e.substr(r.date.length,e.length))),t){var a=u.timezone.exec(t);a?(r.time=t.replace(a[1],""),r.timezone=a[1]):r.time=t}return r}(e);if(s.date){var i=function(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};var a=n[1]?parseInt(n[1]):null,o=n[2]?parseInt(n[2]):null;return{year:null===o?a:100*o,restDateString:e.slice((n[1]||n[2]).length)}}(s.date,n);a=function(e,t){if(null===t)return new Date(NaN);var r=e.match(m);if(!r)return new Date(NaN);var n=!!r[4],a=f(r[1]),o=f(r[2])-1,s=f(r[3]),i=f(r[4]),l=f(r[5])-1;if(n)return function(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}(0,i,l)?function(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var a=7*(t-1)+r+1-(n.getUTCDay()||7);return n.setUTCDate(n.getUTCDate()+a),n}(t,i,l):new Date(NaN);var c=new Date(0);return function(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(y[t]||(S(e)?29:28))}(t,o,s)&&function(e,t){return t>=1&&t<=(S(e)?366:365)}(t,a)?(c.setUTCFullYear(t,o,Math.max(a,s)),c):new Date(NaN)}(i.restDateString,i.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);var d,k=a.getTime(),h=0;if(s.time&&(h=function(e){var t=e.match(p);if(!t)return NaN;var r=v(t[1]),n=v(t[2]),a=v(t[3]);return function(e,t,r){return 24===e?0===t&&0===r:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}(r,n,a)?r*l+6e4*n+1e3*a:NaN}(s.time),isNaN(h)))return new Date(NaN);if(!s.timezone){var T=new Date(k+h),L=new Date(0);return L.setFullYear(T.getUTCFullYear(),T.getUTCMonth(),T.getUTCDate()),L.setHours(T.getUTCHours(),T.getUTCMinutes(),T.getUTCSeconds(),T.getUTCMilliseconds()),L}return d=function(e){if("Z"===e)return 0;var t=e.match(g);if(!t)return 0;var r="+"===t[1]?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return function(e,t){return t>=0&&t<=59}(0,a)?r*(n*l+6e4*a):NaN}(s.timezone),isNaN(d)?new Date(NaN):new Date(k+h+d)}var u={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},m=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,p=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,g=/^([+-])(\d{2})(?::?(\d{2}))?$/;function f(e){return e?parseInt(e):1}function v(e){return e&&parseFloat(e.replace(",","."))||0}var y=[31,null,31,30,31,30,31,31,30,31,30,31];function S(e){return e%400==0||e%4==0&&e%100!=0}var k={};function h(){return k}function T(e,t){var r,n,a,i,l,d,u,m;o(1,arguments);var p=h(),g=c(null!==(r=null!==(n=null!==(a=null!==(i=null==t?void 0:t.weekStartsOn)&&void 0!==i?i:null==t||null===(l=t.locale)||void 0===l||null===(d=l.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==a?a:p.weekStartsOn)&&void 0!==n?n:null===(u=p.locale)||void 0===u||null===(m=u.options)||void 0===m?void 0:m.weekStartsOn)&&void 0!==r?r:0);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=s(e),v=f.getDay(),y=(v<g?7:0)+v-g;return f.setDate(f.getDate()-y),f.setHours(0,0,0,0),f}let L="All Tasks";const D=()=>{const e=r();console.log("projects",e),e.forEach((e=>{document.querySelector(".projectList").appendChild(Q(e))}))},E=(e,t)=>{K(),R(),t.classList.add("selected");const n=r().filter((t=>t.title==e))[0]||[];L=n.title||e,document.querySelector("#taskSection").textContent=`Current section: ${L}`,w(),n.title?n.taskList.forEach((e=>{X(V(e))})):N()},N=()=>{let e=b();"Important Tasks"==L?e=e.filter((e=>e.important)):"Completed Tasks"==L?e=e.filter((e=>e.completed)):"Today"==L?e=e.filter((e=>function(e){return o(1,arguments),function(e,t){o(2,arguments);var r=i(e),n=i(t);return r.getTime()===n.getTime()}(e,Date.now())}(d(e.dueDate)))):"This Week"==L&&(e=e.filter((e=>function(e,t){return o(1,arguments),function(e,t,r){o(2,arguments);var n=T(e,r),a=T(t,r);return n.getTime()===a.getTime()}(e,Date.now(),t)}(d(e.dueDate))))),e.forEach((e=>document.querySelector(".taskList").appendChild(V(e))))},w=()=>{["Completed Tasks","Important Tasks","Today","This Week"].some((e=>e==L))?document.querySelector("#showTaskForm").classList.add("disabled"):document.querySelector("#showTaskForm").classList.remove("disabled")};class q{constructor(e,t,r,n,a){this.title=e,this.description=t,this.dueDate=r,this.priority=n,this.project=a,this.important=!1,this.completed=!1}}let C=[...JSON.parse(localStorage.getItem("TaskList"))||[]];const b=()=>JSON.parse(localStorage.getItem("TaskList"))||[],j=()=>(console.log("CurrentSectionForTask: ",L),L),I=e=>{console.log("deleteTask",e);const{project:r}=b().filter((t=>t.title===e))[0];C=b().filter((t=>t.title!==e)),document.querySelector(".taskList").removeChild(document.querySelector(`.task-${e}`)),"All Tasks"!=r&&(console.log("taskProject",r),((e,r)=>{console.log("deleteTaskFromProject",e),t=t.map((t=>(e==t.title&&(t.taskList=t.taskList.filter((e=>e.title!=r))),t))),localStorage.setItem("ProjectList",JSON.stringify(t))})(r,e)),localStorage.setItem("TaskList",JSON.stringify(C))},O=(e,t,r,n)=>{console.log("updateTaskStatus value: ",r);let a=b().map((a=>(a.title==e&&(a[t]=r,n(a.project,e,t,r)),a)));localStorage.setItem("TaskList",JSON.stringify(a))},A=document.querySelector("#showTaskForm"),M=document.querySelector("#showProjectForm"),P=document.querySelector("#task_dialog"),$=document.querySelector("#project_dialog"),F=document.querySelector("#editTask_dialog"),H=P.querySelectorAll("#cancel_task"),J=F.querySelectorAll("#cancel_EditTask"),U=$.querySelectorAll("#cancel_project"),x=document.querySelector("#task_form"),_=document.querySelector("#project_form"),z=document.querySelector("#AllTasks"),Y=document.querySelector("#ImportantTasks"),Z=document.querySelector("#CompletedTasks"),W=document.querySelector("#TodayTasks"),B=document.querySelector("#ThisWeekTasks"),R=()=>{document.querySelectorAll(".selected").forEach((e=>e.classList.remove("selected")))},G=()=>{document.querySelector(".projectList").textContent=""},K=()=>{document.querySelector(".taskList").textContent=""},Q=({title:e})=>{const r=document.createElement("div"),n=document.createElement("p"),a=document.createElement("img"),o=document.createElement("img");return r.classList.add(`project-${e}`),n.textContent=e,a.src="icons/reorder-horizontal.svg",o.src="icons/delete-icon.svg",a.classList.add("projectIcon"),o.classList.add("deleteProjectBtn"),o.setAttribute("data-title",e),o.addEventListener("click",(()=>{return e=o.dataset.title,t.forEach((t=>{t.title===e&&t.taskList.forEach((e=>{console.log("deleteTask",e.title),I(e.title)}))})),t=t.filter((t=>t.title!==e)),localStorage.setItem("ProjectList",JSON.stringify(t)),G(),D(),void E("All Tasks",document.querySelector("#allTasks"));var e})),n.addEventListener("click",(t=>E(e,t.target.parentElement))),r.appendChild(n),r.appendChild(o),r},V=({title:e,description:t,dueDate:r,priority:a,important:o,completed:s})=>{const i=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div"),d=document.createElement("p"),u=document.createElement("p"),m=document.createElement("p"),p=document.createElement("p"),g=document.createElement("p"),f=document.createElement("p"),v=document.createElement("img"),y=document.createElement("img"),S=document.createElement("img"),k=document.createElement("input");k.setAttribute("type","checkbox"),d.textContent=e,p.textContent=r,p.classList.add("dueDateMainContent"),u.insertAdjacentHTML("afterbegin",`<span class="detailsHeading">Title: </span><span>${e}</span>`),m.insertAdjacentHTML("afterbegin",`<span class="detailsHeading">Description: </span><span>${t}</span>`),g.insertAdjacentHTML("afterbegin",`<span class="detailsHeading">Due Date: </span><span>${r}</span>`),f.insertAdjacentHTML("afterbegin",`<span class="detailsHeading">Priority: </span><span>${a}</span>`),d.addEventListener("click",(()=>c.classList.toggle("show"))),v.src="icons/star.svg",v.classList.add("importantTaskBtn"),o&&v.classList.toggle("importantYellow");let h=o;v.addEventListener("click",(()=>{v.classList.toggle("importantYellow"),O(e,"important",!h,n),h=!h})),y.src="icons/pencil.svg",y.classList.add("editTaskBtn"),y.addEventListener("click",(()=>{ee(e,t,r,a)})),s&&(i.classList.toggle("completed"),k.checked=!0);let T=s;k.addEventListener("change",(()=>{i.classList.toggle("completed"),O(e,"completed",!T,n),T=!T})),S.src="icons/delete-icon.svg",S.classList.add("deleteTaskBtn"),S.addEventListener("click",(()=>I(e)));const L=document.createElement("div");return L.append(k,d),l.classList.add("mainTaskContent"),l.append(L),l.appendChild(p),l.appendChild(v),l.appendChild(y),l.appendChild(S),c.appendChild(u),c.appendChild(m),c.appendChild(g),c.appendChild(f),i.appendChild(l),i.appendChild(c),i.classList.add(`task-${e}`),c.classList.add("collapse"),i},X=e=>{document.querySelector(".taskList").appendChild(e)},ee=(e,t,r,a)=>{let o={title:e,description:t,dueDate:r,priority:a};F.showModal(),document.querySelector("#editTitle").value=e,document.querySelector("#editDescription").value=t,document.querySelector("#editDueDate").value=r,document.querySelector("#editPriority").value=a,F.addEventListener("submit",(t=>{t.preventDefault();let r={title:document.querySelector("#editTitle").value,description:document.querySelector("#editDescription").value,dueDate:document.querySelector("#editDueDate").value,priority:document.querySelector("#editPriority").value};console.log(r);let a=e;for(const[e,t]of Object.entries(r))t!=o[e]&&(console.log("key|value"),console.log({key:e,value:t}),O(a,e,t,n),a=r.title);F.close(),console.log("showEditForm",L.replace(" ","")),E(L,document.querySelector(`#${L.replace(" ","")}`)??document.querySelector(`.project-${L}`))}))};A.addEventListener("click",(()=>P.showModal())),M.addEventListener("click",(()=>$.showModal())),H.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault(),P.close()})))),J.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault(),F.close()})))),U.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault(),$.close()})))),x.addEventListener("submit",(e=>{e.preventDefault(),document.querySelector(".taskList").appendChild(V((()=>{const e=document.querySelector("#title").value,r=document.querySelector("#description").value,n=document.querySelector("#dueDate").value,a=document.querySelector("#priority").value;let o=((e,t,r,n,a)=>new q(e,t,r,n,a))(e,r,n,a,j());return C=b(),C.push(o),((e,r)=>{t=t.map((t=>(t.title===e&&t.taskList.push(r),t))),localStorage.setItem("ProjectList",JSON.stringify(t))})(L,o),localStorage.setItem("TaskList",JSON.stringify(C)),{title:e,description:r,dueDate:n,priority:a,important:!1,completed:!1}})())),P.close()})),_.addEventListener("submit",(r=>{r.preventDefault(),(()=>{const r=document.querySelector("#projectName").value,n=new e(r);console.log("project",n),(e=>{t.push(e),localStorage.setItem("ProjectList",JSON.stringify(t))})(n)})(),G(),D(),$.close()})),z.addEventListener("click",(e=>E("All Tasks",e.target))),Y.addEventListener("click",(e=>E("Important Tasks",e.target))),Z.addEventListener("click",(e=>E("Completed Tasks",e.target))),W.addEventListener("click",(e=>E("Today",e.target))),B.addEventListener("click",(e=>E("This Week",e.target))),D(),E("All Tasks",document.querySelector("#AllTasks"))})();