(()=>{"use strict";class e{constructor(e){this.title=e,this.taskList=[]}}let t=[...JSON.parse(localStorage.getItem("ProjectList"))||[]];const o=()=>JSON.parse(localStorage.getItem("ProjectList"))||[],l=(e,o,l,c)=>{t=t.map((t=>(e===t.title&&t.taskList.forEach((e=>{o===e.title&&(e[l]=c)})),t))),localStorage.setItem("ProjectList",JSON.stringify(t))};let c="All Tasks";const s=()=>{const e=o();console.log("projects",e),e.forEach((e=>{document.querySelector(".projectList").appendChild(I(e))}))},n=e=>{D();const t=o().filter((t=>t.title==e))[0]||[];console.log("displayCurrentSection",t),c=t.title||e,document.querySelector("#taskSection").textContent=`Current section: ${c}`,console.log("selectedProject",t),t.title?t.taskList.forEach((e=>{b(P(e))})):r()},r=()=>{let e=d();console.log("Displaying tasks",e),"Important"==c&&(e=e.filter((e=>e.important))),console.log(e),e.forEach((e=>{document.querySelector(".taskList").appendChild(P(e))}))};class a{constructor(e,t,o,l,c){this.title=e,this.description=t,this.dueDate=o,this.priority=l,this.project=c,this.important=!1,this.completed=!1}}let i=[...JSON.parse(localStorage.getItem("TaskList"))||[]];const d=()=>JSON.parse(localStorage.getItem("TaskList"))||[],u=()=>(console.log("CurrentSectionForTask: ",c),c),p=e=>{console.log("deleteTask",e);const{project:o}=d().filter((t=>t.title===e))[0];i=d().filter((t=>t.title!==e)),document.querySelector(".taskList").removeChild(document.querySelector(`.task-${e}`)),"All Tasks"!=o&&(console.log("taskProject",o),((e,o)=>{console.log("deleteTaskFromProject",e),t=t.map((t=>(e==t.title&&(t.taskList=t.taskList.filter((e=>e.title!=o))),t))),localStorage.setItem("ProjectList",JSON.stringify(t))})(o,e)),localStorage.setItem("TaskList",JSON.stringify(i))},m=(e,t,o,l)=>{console.log("updateTaskStatus value: ",o);let c=d().map((c=>(c.title==e&&(c[t]=o,l(c.project,e,t,o)),c)));localStorage.setItem("TaskList",JSON.stringify(c))},g=document.querySelector("#showTaskForm"),S=document.querySelector("#showProjectForm"),k=document.querySelector("#task_dialog"),y=document.querySelector("#project_dialog"),L=document.querySelector("#editTask_dialog"),v=k.querySelectorAll("#cancel_task"),h=L.querySelectorAll("#cancel_EditTask"),E=y.querySelector("#cancel_project"),f=document.querySelector("#task_form"),q=document.querySelector("#project_form"),j=document.querySelector("#allTasks"),C=document.querySelector("#importantTasks"),T=()=>{document.querySelector(".projectList").textContent=""},D=()=>{document.querySelector(".taskList").textContent=""},I=({title:e})=>{const o=document.createElement("div"),l=document.createElement("p"),c=document.createElement("img");return o.classList.add(`project-${e}`),l.textContent=e,c.src="icons/delete-icon.svg",c.classList.add("deleteProjectBtn"),c.setAttribute("data-title",e),c.addEventListener("click",(()=>{return e=c.dataset.title,t.forEach((t=>{t.title===e&&t.taskList.forEach((e=>{console.log("deleteTask",e.title),p(e.title)}))})),t=t.filter((t=>t.title!==e)),localStorage.setItem("ProjectList",JSON.stringify(t)),T(),void s();var e})),l.addEventListener("click",(()=>n(e))),o.appendChild(l),o.appendChild(c),o},P=({title:e,description:t,dueDate:o,priority:c,important:s,completed:n})=>{const r=document.createElement("div"),a=document.createElement("div"),i=document.createElement("div"),d=document.createElement("p"),u=document.createElement("p"),g=document.createElement("p"),S=document.createElement("p"),k=document.createElement("p"),y=document.createElement("button"),L=document.createElement("button"),v=document.createElement("button"),h=document.createElement("input");h.setAttribute("type","checkbox"),d.textContent=e,u.insertAdjacentHTML("afterbegin",`<span class="detailsHeading">Title: </span><span>${e}</span>`),g.insertAdjacentHTML("afterbegin",`<span class="detailsHeading">Description: </span><span>${t}</span>`),S.insertAdjacentHTML("afterbegin",`<span class="detailsHeading">Due Date: </span><span>${o}</span>`),k.insertAdjacentHTML("afterbegin",`<span class="detailsHeading">Priority: </span><span>${c}</span>`),d.addEventListener("click",(()=>i.classList.toggle("show"))),y.textContent="Important",s&&y.classList.toggle("importantYellow");let E=s;y.addEventListener("click",(()=>{y.classList.toggle("importantYellow"),m(e,"important",!E,l),E=!E})),L.textContent="Edit",L.addEventListener("click",(()=>{N(e,t,o,c)})),n&&(r.classList.toggle("completed"),h.checked=!0);let f=n;h.addEventListener("change",(()=>{r.classList.toggle("completed"),m(e,"completed",!f,l),f=!f})),v.textContent="Delete Task",v.addEventListener("click",(()=>p(e)));const q=document.createElement("div");return q.append(h,d),a.append(q),a.appendChild(y),a.appendChild(L),a.appendChild(v),i.appendChild(u),i.appendChild(g),i.appendChild(S),i.appendChild(k),r.appendChild(a),r.appendChild(i),r.classList.add(`task-${e}`),i.classList.add("collapse"),r},b=e=>{document.querySelector(".taskList").appendChild(e)},N=(e,t,o,s)=>{let r={title:e,description:t,dueDate:o,priority:s};L.showModal(),document.querySelector("#editTitle").value=e,document.querySelector("#editDescription").value=t,document.querySelector("#editDueDate").value=o,document.querySelector("#editPriority").value=s,L.addEventListener("submit",(t=>{t.preventDefault();let o={title:document.querySelector("#editTitle").value,description:document.querySelector("#editDescription").value,dueDate:document.querySelector("#editDueDate").value,priority:document.querySelector("#editPriority").value};console.log(o);let s=e;for(const[e,t]of Object.entries(o))t!=r[e]&&(console.log("key|value"),console.log({key:e,value:t}),m(s,e,t,l),s=o.title);L.close(),console.log("showEditForm",c),n(c)}))};g.addEventListener("click",(()=>k.showModal())),S.addEventListener("click",(()=>y.showModal())),v.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault(),k.close()})))),h.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault(),L.close()})))),E.addEventListener("click",(e=>{e.preventDefault(),y.close()})),f.addEventListener("submit",(e=>{e.preventDefault(),document.querySelector(".taskList").appendChild(P((()=>{const e=document.querySelector("#title").value,o=document.querySelector("#description").value,l=document.querySelector("#dueDate").value,s=document.querySelector("#priority").value;let n=((e,t,o,l,c)=>new a(e,t,o,l,c))(e,o,l,s,u());return i=d(),i.push(n),((e,o)=>{t=t.map((t=>(t.title===e&&t.taskList.push(o),t))),localStorage.setItem("ProjectList",JSON.stringify(t))})(c,n),localStorage.setItem("TaskList",JSON.stringify(i)),{title:e,description:o,dueDate:l,priority:s,important:!1,completed:!1}})())),k.close()})),q.addEventListener("submit",(o=>{o.preventDefault(),(()=>{const o=document.querySelector("#projectName").value,l=new e(o);console.log("project",l),(e=>{t.push(e),localStorage.setItem("ProjectList",JSON.stringify(t))})(l)})(),T(),s(),y.close()})),j.addEventListener("click",(()=>n("All Tasks"))),C.addEventListener("click",(()=>n("Important"))),s(),n("All Tasks")})();