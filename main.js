(()=>{"use strict";class t{constructor(t){this.title=t,this.taskList=[]}}let e=[...JSON.parse(localStorage.getItem("ProjectList"))||[]];const o=()=>JSON.parse(localStorage.getItem("ProjectList"))||[];let l="All Tasks";const r=()=>{const t=o();console.log("projects",t),t.forEach((t=>{document.querySelector(".projectList").appendChild(f(t))}))},s=()=>{const t=a();console.log("Displaying tasks",t),t.forEach((t=>{document.querySelector(".taskList").appendChild(j(t))}))},c=t=>{const e=o().filter((e=>e.title==t.split("-")[1]))[0]||[];l=e.title||"All Tasks",document.querySelector("#taskSection").textContent=`Current section: ${l}`,console.log("selectedProject",e),e.title?e.taskList.forEach((t=>{q(j(t))})):s()};class n{constructor(t,e,o,l,r){this.title=t,this.description=e,this.dueDate=o,this.priority=l,this.project=r,this.important=!1}getTitle=()=>this.title;setTitle=t=>{this.title=t}}let i=[...JSON.parse(localStorage.getItem("TaskList"))||[]];const a=()=>JSON.parse(localStorage.getItem("TaskList"))||[],d=()=>(console.log("CurrentSectionForTask: ",l),l),u=t=>{console.log("deleteTask",t);const{project:o}=i.filter((e=>e.title===t))[0];i=i.filter((e=>e.title!==t)),localStorage.setItem("TaskList",JSON.stringify(i)),document.querySelector(".taskList").removeChild(document.querySelector(`.task-${t}`)),"All Tasks"!=o&&(console.log("taskProject",o),((t,o)=>{console.log("deleteTaskFromProject",t),e=e.map((e=>(t==e.title&&(e.taskList=e.taskList.filter((t=>t.title!=o))),e))),localStorage.setItem("ProjectList",JSON.stringify(e))})(o,t))},m=document.querySelector("#showTaskForm"),p=document.querySelector("#showProjectForm"),S=document.querySelector("#task_dialog"),k=document.querySelector("#project_dialog"),g=S.querySelector("#cancel_task"),L=k.querySelector("#cancel_project"),h=document.querySelector("#task_form"),y=document.querySelector("#project_form"),v=document.querySelector("#allTasks"),E=()=>{document.querySelector(".projectList").textContent=""},C=()=>{document.querySelector(".taskList").textContent=""},f=({title:t})=>{const o=document.createElement("div"),l=document.createElement("p"),s=document.createElement("button");return o.classList.add(`project-${t}`),l.textContent=t,s.textContent="Delete",s.setAttribute("data-title",t),s.addEventListener("click",(()=>{return t=s.dataset.title,e.forEach((e=>{e.title===t&&e.taskList.forEach((t=>{console.log("deleteTask",t.title),u(t.title)}))})),e=e.filter((e=>e.title!==t)),localStorage.setItem("ProjectList",JSON.stringify(e)),E(),void r();var t})),l.addEventListener("click",(()=>{C(),c(o.classList.value)})),o.appendChild(l),o.appendChild(s),o},j=({title:t,description:o,dueDate:l,priority:r,important:s})=>{const c=document.createElement("div"),n=document.createElement("p"),i=document.createElement("p"),d=document.createElement("p"),m=document.createElement("p"),p=document.createElement("button"),S=document.createElement("button");return n.textContent=t,i.textContent=o,d.textContent=l,m.textContent=r,p.textContent="Important",s&&p.classList.toggle("importantYellow"),p.addEventListener("click",(()=>{p.classList.toggle("importantYellow"),(t=>{let o=a().map((o=>{var l,r;return o.title==t&&(o.important=!o.important,l=o.project,r=t,e=e.map((t=>(l===t.title&&t.taskList.forEach((t=>{r===t.title&&(t.important=!t.important)})),t))),localStorage.setItem("ProjectList",JSON.stringify(e))),console.log(o),o}));localStorage.setItem("TaskList",JSON.stringify(o))})(t)})),S.textContent="Delete Task",S.addEventListener("click",(()=>u(t))),c.appendChild(n),c.appendChild(i),c.appendChild(d),c.appendChild(m),c.appendChild(p),c.appendChild(S),c.classList.add(`task-${t}`),c},q=t=>{document.querySelector(".taskList").appendChild(t)};m.addEventListener("click",(()=>S.showModal())),p.addEventListener("click",(()=>k.showModal())),g.addEventListener("click",(t=>{t.preventDefault(),S.close()})),L.addEventListener("click",(t=>{t.preventDefault(),k.close()})),h.addEventListener("submit",(t=>{t.preventDefault(),document.querySelector(".taskList").appendChild(j((()=>{const t=document.querySelector("#title").value,o=document.querySelector("#description").value,r=document.querySelector("#dueDate").value,s=document.querySelector("#priority").value;let c=((t,e,o,l,r)=>new n(t,e,o,l,r))(t,o,r,s,d());return i.push(c),localStorage.setItem("TaskList",JSON.stringify(i)),((t,o)=>{e=e.map((e=>(e.title===t&&e.taskList.push(o),e))),localStorage.setItem("ProjectList",JSON.stringify(e))})(l,c),{title:t,description:o,dueDate:r,priority:s,important:!1}})())),S.close()})),y.addEventListener("submit",(o=>{o.preventDefault(),(()=>{const o=document.querySelector("#projectName").value,l=new t(o);console.log("project",l),(t=>{e.push(t),localStorage.setItem("ProjectList",JSON.stringify(e))})(l)})(),E(),r(),k.close()})),v.addEventListener("click",(()=>{c("All Tasks"),C(),s()})),r(),s()})();